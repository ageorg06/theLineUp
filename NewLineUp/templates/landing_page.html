{% extends "base.html" %}

{% block content %}
<div class="container mt-5">

    <!-- Include necessary scripts and styles for FullCalendar -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script>

    <script>
        // Parse the serialized barber data
        var barbers = JSON.parse('{{ barber_data_json|escapejs }}');

        $(document).ready(function() {
            // Loop through each barber and display a calendar
            barbers.forEach(function(barber) {
                // Barber Name
                var barberName = barber.fields.name;  // Adjust based on your Barber model's fields
                $("body").append("<h2>" + barberName + "</h2>");

                // Calendar container for each barber
                var calendarId = 'calendar-' + barber.pk;
                $("body").append("<div id='" + calendarId + "'></div>");

                // Initialize the calendar for each barber
                $('#' + calendarId).fullCalendar({
                    header: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'month,agendaWeek,agendaDay'
                    },
                    defaultView: 'agendaDay',
                    slotDuration: '00:30:00',
                    businessHours: {
                        start: '09:00',
                        end: '17:00',
                        dow: [1, 2, 3, 4, 5]
                    }
                });
            });
        });
    </script>
</div>
{% endblock %}
